### HTTP的质询/认证框架

服务器在接收到请求报文后，先不按要求执行动作，先以认证质询进行响应，要求用户提供一些保密信息。再次请求时，用户要附上响应的用户名/密码，服务器判断保密证书是否匹配。

### 认证

#### 1. 认证的步骤

- **质询**：用户发送第一条请求，没有认证信息。服务器返回401 Unauthorized，拒绝请求，要求提供用户名/密码，回送WWW-Authenticate首部
- **授权**：客户端重新发送请求，附加**Authorization**首部，说明用户名/密码等
- **成功**：如果授权证书匹配，服务器就返回请求的文档，在**Authorization-Info**首部返回授权会话相关的信息，返回200

#### 2. 安全域

Web服务器将受保护的文档组织成一个安全域，每个域有一个描述性的名称，以便用户提供认证。



### 基本认证

基本认证中，服务器可以拒绝一个事务，质询客户端要求用户提供认证信息，返回401状态码。便捷灵活。

安全缺陷：

- 通过网络发送用户名/密码，以明文形式传输，易被捕获，需要通过SSL加密信道发送。

- 没有提供针对代理和中间节点的防护措施。

- 恶意服务器，攻击者可能请求用户输入密码。

  

### 摘要认证

#### 1. 对比基本认证的改进

- 不以明文方式在网络上发送密码
- 防止恶意用户捕获/重放认证的握手过程
- 防范常见的攻击方式
- 有选择的防止篡改报文内容

#### 2. 保护密码

- 不通过网络发送密码，只发送指纹或密码摘要

#### 3. 随机数防止重放攻击

- 服务器向客户端发送随机数
- 摘要随着随机数的变化而变化，攻击者没有密码，因此无法计算出摘要，防止了重放攻击

