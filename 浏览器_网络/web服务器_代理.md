## web服务器

### web服务器的作用

对HTTP请求进行处理和响应。

- 建立连接：接受客户端的链接
- 接受请求：从网络中读取HTTP报文
- 处理请求：解释HTTP报文并执行操作
- 访问资源：访问报文中指定的资源
- 构建响应：创建HTTP响应报文
- 发送响应：将响应发送给客户端
- 记录事务：将完成的任务记录在日志中

### web服务器内部实现

- 处理新的连接，确定客户端用户，进行日志记录和访问控制。
- 连接的IO处理：
  1. 多线程多进程：内存消耗大
  2. 复用IO：同时监视所有连接，对有状态变化的连接做出响应，空闲连接不会绑定进程和线程。
  3. 复用多线程：对每条连接都进行观察并执行少量任务。
- 访问资源：
  1. docroot：服务器文档根目录
  2. 请求目录：返回默认index文件



## Proxy - 代理

作为中间人，为为客户端提供更好的服务。代理服务器既是服务器又是客户端。连接的是两个或多个使用相同协议的应用程序。

### 为什么使用代理？

改善安全性，提高性能，节省费用，监视服务器流量。

- 儿童过滤器：维护黑名单，屏蔽部分网站
- 访问控制：在多个服务器之间进行访问控制（代理认证）
- 安全防火墙：限制数据流入/流出，检查网络流量
- Web缓存
- 反向代理：服务器加速器
- 内容路由器：将请求导向特定的web服务器
- 转码器：翻译文本等
- 匿名代理：从HTTP报文中删除身份特性

### 如果将流量发送给代理？

- 修改客户端：自动/手动代理配置，将HTTP请求直接发送给代理
- 修改网络：拦截网络流量并导入代理
- 修改DNS命名空间
- 服务器重定向

### 追踪报文

- via首部
  	1. 记录报文的转发，标识发送者们的协议能力，检测路由循环
   	2. 大多数情况请求和响应路径的via首部相反
   	3. 记录非HTTP的协议转换
   	4. 安全性：用适当的假名取代主机名
- TRACE方法
  1. Max-Forward: 限制报文的最大转发次数
- OPTION方法
  1. 用来确定服务端的能力，判定服务端支持的方法
  2. Allow首部：列出请求的资源所支持的方法列表





